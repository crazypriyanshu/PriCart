<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>PriCart Secure Payment</title>
</head>
<body style="text-align:center; padding-top:50px; font-family:sans-serif; background:#f4f4f4;">

<div style="background:white; display:inline-block; padding:40px; border-radius:10px; shadow: 0 4px 8px rgba(0,0,0,0.1);">
    <h2>Complete Your Payment</h2>
    <p>Order ID: <span th:text="${orderId}"></span></p>
    <p>Amount: â‚¹<span th:text="${amount/100}"></span></p>

    <button id="rzp-button1" style="background:#3399cc;color:white;border:none;padding:15px 30px;font-size:18px;border-radius:5px;cursor:pointer;">
        Pay with Razorpay
    </button>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script th:inline="javascript">
    // Thymeleaf injects these values from the Java Controller
    const options = {
        "key": [[${apiKey}]],
        "amount": [[${amount}]],
        "currency": [[${currency}]],
        "name": "PriCart",
        "description": "Order Payment",
        "order_id": [[${rzpOrderId}]],
        "handler": function (response){
            alert("Payment Successful! Processing on server...");
            // You don't NEED a redirect here because the Webhook
            // will handle the DB update and Kafka notification.
        },
        "theme": { "color": "#3399cc" }
    };

    const rzp1 = new Razorpay(options);
    document.getElementById('rzp-button1').onclick = function(e){
        rzp1.open();
        e.preventDefault();
    }
</script>
</body>
</html>